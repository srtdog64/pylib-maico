from enum import IntEnum


def _int32(value: int) -> int:
    if value & (1 << 31):
        value -= 1 << 32
    return value


class DCAMERR(IntEnum):
    SUCCESS = 1
    BUSY = _int32(0x80000101)
    NOTREADY = _int32(0x80000103)
    NOTSTABLE = _int32(0x80000104)
    UNSTABLE = _int32(0x80000105)
    NOTBUSY = _int32(0x80000107)
    EXCLUDED = _int32(0x80000110)
    ABORT = _int32(0x80000102)
    TIMEOUT = _int32(0x80000106)
    LOSTFRAME = _int32(0x80000301)
    NORESOURCE = _int32(0x80000201)
    NOMEMORY = _int32(0x80000203)
    NOMODULE = _int32(0x80000204)
    NODRIVER = _int32(0x80000205)
    NOCAMERA = _int32(0x80000206)
    INVALIDCAMERA = _int32(0x80000806)
    INVALIDHANDLE = _int32(0x80000807)
    INVALIDPARAM = _int32(0x80000808)
    INVALIDVALUE = _int32(0x80000821)
    OUTOFRANGE = _int32(0x80000822)
    NOTWRITABLE = _int32(0x80000823)
    NOTREADABLE = _int32(0x80000824)
    INVALIDPROPERTYID = _int32(0x80000825)
    NOTSUPPORT = _int32(0x80000f03)
    FAILREADCAMERA = _int32(0x83001002)
    FAILWRITECAMERA = _int32(0x83001003)


class DCAMPropertyID(IntEnum):
    # Trigger properties
    TRIGGERSOURCE = 0x00100110
    TRIGGERACTIVE = 0x00100120
    TRIGGER_MODE = 0x00100210
    TRIGGERPOLARITY = 0x00100220
    TRIGGER_CONNECTOR = 0x00100230
    TRIGGERDELAY = 0x00100260
    # Exposure
    EXPOSURETIME = 0x001F0110
    EXPOSURETIME_CONTROL = 0x001F0130
    # Output trigger
    OUTPUTTRIGGER_SOURCE = 0x001C0110
    OUTPUTTRIGGER_POLARITY = 0x001C0120
    OUTPUTTRIGGER_ACTIVE = 0x001C0130
    OUTPUTTRIGGER_DELAY = 0x001C0140
    OUTPUTTRIGGER_PERIOD = 0x001C0150
    OUTPUTTRIGGER_KIND = 0x001C0160
    # Sensor
    SENSORTEMPERATURE = 0x00200310
    SENSORCOOLER = 0x00200320
    SENSORTEMPERATURETARGET = 0x00200330
    READOUTSPEED = 0x00400110
    MECHANICALSHUTTER = 0x001E0110
    # Image properties (from dcamapi4.py)
    BINNING = 0x00401110  # 4198672
    FRAMEAVERAGINGMODE = 0x003803A0  # 3670944
    FRAMEAVERAGINGFRAMES = 0x003803B0  # 3670960
    # Confocal scanner properties (from dcamapi4.py - C15890 specific)
    CONFOCAL_SCANMODE = 0x00910010  # 9502736
    CONFOCAL_SCANLINES = 0x00910020  # 9502752
    CONFOCAL_ZOOM = 0x00910030  # 9502768
    # Subunit properties (from dcamapi4.py - laser channels)
    NUMBEROF_SUBUNIT = 0x009100F0  # 9502960
    SUBUNIT_CONTROL = 0x00910100  # 9502976
    SUBUNIT_LASERPOWER = 0x00910200  # 9503232
    SUBUNIT_PMTGAIN = 0x00910300  # 9503488
    SUBUNIT_WAVELENGTH = 0x00910500  # 9504000


SUBUNIT_OFFSET = 0x10


class DCAMTriggerSource(IntEnum):
    INTERNAL = 1
    EXTERNAL = 2
    SOFTWARE = 3
    MASTERPULSE = 4


class DCAMTriggerPolarity(IntEnum):
    NEGATIVE = 1
    POSITIVE = 2


class DCAMOutputTriggerKind(IntEnum):
    LOW = 1
    EXPOSURE = 2
    PROGRAMABLE = 3
    TRIGGER_READY = 4
    HIGH = 5


class DCAMCaptureMode(IntEnum):
    SNAP = 0
    SEQUENCE = 1


class DCAMSubunitControl(IntEnum):
    NOT_INSTALLED = 0
    OFF = 1
    ON = 2


class DCAMShutterState(IntEnum):
    CLOSE = 2
    OPEN = 3


class DCAMScanMode(IntEnum):
    SEQUENTIAL = 1
    SIMULTANEOUS = 2


class DCAMFrameAveraging(IntEnum):
    OFF = 1
    ON = 2
